<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>C.Freitas Perfumary</title>

<script src="https://cdn.tailwindcss.com"></script>

<link href="https://fonts.googleapis.com/css2?family=Playfair+Display:wght@600;700&family=Montserrat:wght@500;600&display=swap" rel="stylesheet">

<style>
body{
  background: linear-gradient(135deg,#f5efe6,#e8dccf);
  font-family:'Montserrat',sans-serif;
}

/* LOGO */
.logo-box{
  background: linear-gradient(135deg,#f5efe6,#7a5c48);
  border-radius:20px;
  padding:18px 30px;
  position:relative;
  overflow:hidden;
  box-shadow:0 10px 30px rgba(0,0,0,.25);
}
.logo-text{
  font-family:'Playfair Display',serif;
  font-size:32px;
  letter-spacing:3px;
  color:#3b2a21;
}
.logo-sub{
  font-size:12px;
  letter-spacing:5px;
  margin-top:4px;
}
.gold-bar{
  position:absolute;
  bottom:0;
  left:-100%;
  width:200%;
  height:6px;
  background:linear-gradient(90deg,#8b6b2e,#e6c36a,#fff1a8,#e6c36a,#8b6b2e);
  animation:goldMove 3s linear infinite;
}
@keyframes goldMove{
  to{transform:translateX(50%)}
}
</style>

<!-- FIREBASE -->
<script type="module">
import { initializeApp } from "https://www.gstatic.com/firebasejs/10.12.2/firebase-app.js";
import { getDatabase, ref, push, onValue, remove, update } from "https://www.gstatic.com/firebasejs/10.12.2/firebase-database.js";

const firebaseConfig = {
  apiKey: "AIzaSyCNcjKdISg8-X8QPFPY3pAqTCfjAa3Ie1M",
  authDomain: "cfreitas-perfumary.firebaseapp.com",
  projectId: "cfreitas-perfumary",
  databaseURL: "https://cfreitas-perfumary-default-rtdb.firebaseio.com",
};

const app = initializeApp(firebaseConfig);
const db = getDatabase(app);
const productsRef = ref(db, "products");

const ADMIN_PASSWORD = "cfreitas2025";
let isAdmin = false;
let editingId = null;

window.onload = () => {
  const grid = document.getElementById("productsGrid");

  onValue(productsRef, snap => {
    grid.innerHTML = "";
    snap.forEach(child => {
      const p = child.val();
      const id = child.key;

      grid.innerHTML += `
      <div class="bg-white rounded-xl shadow-xl overflow-hidden relative">
        <img src="${p.image}" class="w-full h-64 object-cover"
        onerror="this.src='https://via.placeholder.com/400x400?text=Imagem+Inv√°lida'">
        ${isAdmin ? `
        <div class="absolute top-2 right-2 flex gap-2">
          <button onclick="editProduct('${id}','${p.name}','${p.image}')" class="bg-blue-500 text-white px-3 py-1 rounded">‚úè</button>
          <button onclick="deleteProduct('${id}')" class="bg-red-500 text-white px-3 py-1 rounded">üóë</button>
        </div>` : ``}
        <div class="p-4 text-center font-semibold">${p.name}</div>
      </div>`;
    });
  });

  document.getElementById("loginBtn").onclick = () => {
    const pass = prompt("Senha admin:");
    if(pass === ADMIN_PASSWORD){
      isAdmin = true;
      document.getElementById("adminPanel").classList.remove("hidden");
      alert("Admin ativado");
    } else alert("Senha errada");
  };

  document.getElementById("saveProduct").onclick = () => {
    const name = productName.value;
    const image = productImage.value;

    if(!name || !image) return alert("Preencha tudo");

    if(editingId){
      update(ref(db,"products/"+editingId),{name,image});
      editingId = null;
    }else{
      push(productsRef,{name,image});
    }

    productName.value="";
    productImage.value="";
  };
};

window.deleteProduct = id => remove(ref(db,"products/"+id));

window.editProduct = (id,name,image) => {
  editingId = id;
  productName.value = name;
  productImage.value = image;
};
</script>
</head>

<body>

<header class="flex justify-center py-8">
  <div class="logo-box text-center">
    <div class="logo-text">CFREITAS</div>
    <div class="logo-sub">PERFUMARY</div>
    <div class="gold-bar"></div>
  </div>
</header>

<div class="text-center mb-6">
  <button id="loginBtn" class="bg-amber-700 text-white px-6 py-2 rounded-full shadow-lg">
    üîí Admin
  </button>
</div>

<div id="adminPanel" class="hidden max-w-md mx-auto bg-white p-6 rounded-xl shadow-xl mb-10">
  <h2 class="text-xl font-semibold mb-4 text-center">Painel Admin</h2>
  <input id="productName" placeholder="Nome do produto" class="w-full border p-2 mb-3">
  <input id="productImage" placeholder="URL da imagem (termina em .jpg/.png)" class="w-full border p-2 mb-3">
  <button id="saveProduct" class="w-full bg-green-600 text-white py-2 rounded">Salvar</button>
</div>

<main class="max-w-7xl mx-auto px-6">
  <div id="productsGrid" class="grid grid-cols-1 md:grid-cols-3 gap-8"></div>
</main>

</body>
</html>
