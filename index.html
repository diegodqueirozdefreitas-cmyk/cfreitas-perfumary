<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>C.Freitas Perfumary</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        @keyframes pulseSlow {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.5; }
        }
        @keyframes spinSlow {
            from { transform: rotate(0deg); }
            to { transform: rotate(360deg); }
        }
        .pulse-slow { animation: pulseSlow 2s ease-in-out infinite; }
        .spin-slow { animation: spinSlow 3s linear infinite; }
    </style>
</head>
<body class="min-h-screen bg-gradient-to-br from-pink-50 via-white to-purple-50">
    <header class="bg-white shadow-md sticky top-0 z-50">
        <div class="max-w-7xl mx-auto px-4 py-6 flex justify-between items-center">
            <div class="flex items-center gap-4">
                <div class="relative w-16 h-16">
                    <div class="absolute inset-0 bg-gradient-to-br from-pink-400 to-purple-600 rounded-full animate-pulse opacity-20"></div>
                    <div class="absolute inset-0 flex items-center justify-center">
                        <span class="text-4xl font-serif font-bold bg-gradient-to-br from-pink-500 to-purple-600 bg-clip-text text-transparent pulse-slow">C</span>
                    </div>
                    <div class="absolute inset-0 border-2 border-pink-300 rounded-full spin-slow"></div>
                </div>
                <div>
                    <h1 class="text-3xl font-serif font-bold bg-gradient-to-r from-pink-600 to-purple-600 bg-clip-text text-transparent">C.Freitas</h1>
                    <p class="text-sm text-gray-600 italic">Perfumary</p>
                </div>
            </div>
            <button id="loginBtn" class="flex items-center gap-2 px-4 py-2 bg-purple-600 text-white rounded-lg hover:bg-purple-700 transition-colors text-sm">
                <span>üîí</span> Login Admin
            </button>
            <button id="logoutBtn" style="display: none;" class="flex items-center gap-2 px-4 py-2 bg-red-600 text-white rounded-lg hover:bg-red-700 transition-colors text-sm">
                <span>üö™</span> Sair do Admin
            </button>
        </div>
    </header>

    <div id="loginModal" style="display: none;" class="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4">
        <div class="bg-white rounded-lg shadow-xl max-w-md w-full p-6">
            <div class="flex justify-between items-center mb-4">
                <h3 class="text-xl font-bold text-gray-800">Login Administrativo</h3>
                <button id="closeLoginModal" class="text-gray-500 hover:text-gray-700 text-2xl">&times;</button>
            </div>
            <div class="space-y-4">
                <div>
                    <label class="block text-sm font-medium text-gray-700 mb-2">Senha</label>
                    <input type="password" id="passwordInput" class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-transparent" placeholder="Digite a senha">
                    <p id="loginError" style="display: none;" class="text-red-500 text-sm mt-2">Senha incorreta!</p>
                </div>
                <button id="loginSubmit" class="w-full py-3 bg-gradient-to-r from-pink-500 to-purple-600 text-white rounded-lg hover:from-pink-600 hover:to-purple-700 transition-all font-medium">Entrar</button>
            </div>
        </div>
    </div>

    <main class="max-w-7xl mx-auto px-4 py-12">
        <div id="adminControls" style="display: none;" class="mb-8 flex justify-center">
            <button id="addProductBtn" class="flex items-center gap-2 px-6 py-3 bg-pink-500 text-white rounded-lg hover:bg-pink-600 transition-colors shadow-lg">
                <span>‚ûï</span> Adicionar Produto
            </button>
        </div>

        <div id="productForm" style="display: none;" class="mb-8 max-w-md mx-auto bg-white p-6 rounded-lg shadow-lg">
            <div class="flex justify-between items-center mb-4">
                <h3 id="formTitle" class="text-xl font-bold text-gray-800">Novo Produto</h3>
                <button id="closeForm" class="text-gray-500 hover:text-gray-700 text-2xl">&times;</button>
            </div>
            <div class="space-y-4">
                <div>
                    <label class="block text-sm font-medium text-gray-700 mb-2">Nome do Produto</label>
                    <input type="text" id="productName" class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-pink-500 focus:border-transparent" placeholder="Ex: Perfume Floral">
                </div>
                <div>
                    <label class="block text-sm font-medium text-gray-700 mb-2">URL da Imagem</label>
                    <input type="text" id="productImage" class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-pink-500 focus:border-transparent" placeholder="https://...">
                    <p class="text-xs text-gray-500 mt-1">Dica: Fa√ßa upload em imgur.com e cole o link aqui</p>
                </div>
                <button id="saveProduct" class="w-full py-3 bg-gradient-to-r from-pink-500 to-purple-600 text-white rounded-lg hover:from-pink-600 hover:to-purple-700 transition-all font-medium">Adicionar Produto</button>
            </div>
        </div>

        <div id="productsGrid" class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-8"></div>
        <div id="emptyState" style="display: none;" class="text-center py-20">
            <p class="text-gray-500 text-lg">Nenhum produto cadastrado ainda.</p>
        </div>
    </main>

    <footer class="bg-gradient-to-r from-pink-600 to-purple-600 text-white py-8 mt-20">
        <div class="max-w-7xl mx-auto px-4 text-center">
            <p class="text-lg font-serif">C.Freitas Perfumary</p>
            <p class="text-sm mt-2 opacity-90">Fragr√¢ncias que contam hist√≥rias</p>
        </div>
    </footer>

    <script>
        const ADMIN_PASSWORD = 'cfreitas2025';
        let isAdmin = false;
        let products = [];
        let editingId = null;

        const elements = {
            loginBtn: document.getElementById('loginBtn'),
            logoutBtn: document.getElementById('logoutBtn'),
            loginModal: document.getElementById('loginModal'),
            closeLoginModal: document.getElementById('closeLoginModal'),
            passwordInput: document.getElementById('passwordInput'),
            loginSubmit: document.getElementById('loginSubmit'),
            loginError: document.getElementById('loginError'),
            adminControls: document.getElementById('adminControls'),
            addProductBtn: document.getElementById('addProductBtn'),
            productForm: document.getElementById('productForm'),
            closeForm: document.getElementById('closeForm'),
            formTitle: document.getElementById('formTitle'),
            productName: document.getElementById('productName'),
            productImage: document.getElementById('productImage'),
            saveProduct: document.getElementById('saveProduct'),
            productsGrid: document.getElementById('productsGrid'),
            emptyState: document.getElementById('emptyState')
        };

        async function loadProducts() {
            try {
                const result = await window.storage.get('products-data', true);
                if (result && result.value) {
                    products = JSON.parse(result.value);
                } else {
                    products = [
                        { id: 1, name: 'Perfume Floral Elegance', image: 'https://images.unsplash.com/photo-1588405748880-12d1d2a59d75?w=400&h=400&fit=crop' },
                        { id: 2, name: 'Eau de Toilette Citrus', image: 'https://images.unsplash.com/photo-1592945403244-b3fbafd7f539?w=400&h=400&fit=crop' },
                        { id: 3, name: 'Perfume Amadeirado', image: 'https://images.unsplash.com/photo-1541643600914-78b084683601?w=400&h=400&fit=crop' }
                    ];
                    await window.storage.set('products-data', JSON.stringify(products), true);
                }
            } catch (error) {
                products = [
                    { id: 1, name: 'Perfume Floral Elegance', image: 'https://images.unsplash.com/photo-1588405748880-12d1d2a59d75?w=400&h=400&fit=crop' },
                    { id: 2, name: 'Eau de Toilette Citrus', image: 'https://images.unsplash.com/photo-1592945403244-b3fbafd7f539?w=400&h=400&fit=crop' },
                    { id: 3, name: 'Perfume Amadeirado', image: 'https://images.unsplash.com/photo-1541643600914-78b084683601?w=400&h=400&fit=crop' }
                ];
            }
            renderProducts();
        }

        async function saveProducts() {
            try {
                await window.storage.set('products-data', JSON.stringify(products), true);
                showNotification('‚úÖ Salvo! Vis√≠vel em todos os dispositivos');
            } catch (error) {
                console.error('Erro ao salvar:', error);
                showNotification('‚ùå Erro ao salvar. Tente novamente.');
            }
        }

        function showNotification(message) {
            const notification = document.createElement('div');
            notification.textContent = message;
            notification.className = 'fixed top-20 right-4 bg-green-500 text-white px-6 py-3 rounded-lg shadow-lg z-50 animate-bounce';
            document.body.appendChild(notification);
            setTimeout(function() {
                notification.remove();
            }, 3000);
        }

        function renderProducts() {
            if (products.length === 0) {
                elements.productsGrid.style.display = 'none';
                elements.emptyState.style.display = 'block';
                return;
            }
            elements.productsGrid.style.display = 'grid';
            elements.emptyState.style.display = 'none';
            
            elements.productsGrid.innerHTML = products.map(function(product) {
                const adminButtons = isAdmin ? 
                    '<div class="absolute top-2 right-2 flex gap-2">' +
                    '<button onclick="editProduct(' + product.id + ')" class="p-2 bg-blue-500 text-white rounded-full hover:bg-blue-600 transition-colors shadow-lg">‚úèÔ∏è</button>' +
                    '<button onclick="deleteProduct(' + product.id + ')" class="p-2 bg-red-500 text-white rounded-full hover:bg-red-600 transition-colors shadow-lg">üóëÔ∏è</button>' +
                    '</div>' : '';
                
                return '<div class="group bg-white rounded-xl shadow-lg overflow-hidden hover:shadow-2xl transition-all duration-300 transform hover:-translate-y-2">' +
                    '<div class="relative h-64 overflow-hidden bg-gradient-to-br from-pink-100 to-purple-100">' +
                    '<img src="' + product.image + '" alt="' + product.name + '" class="w-full h-full object-cover group-hover:scale-110 transition-transform duration-500">' +
                    adminButtons +
                    '</div>' +
                    '<div class="p-6">' +
                    '<h3 class="text-xl font-semibold text-gray-800 text-center">' + product.name + '</h3>' +
                    '</div>' +
                    '</div>';
            }).join('');
        }

        setInterval(async function() {
            if (!isAdmin) {
                try {
                    const result = await window.storage.get('products-data', true);
                    if (result && result.value) {
                        const newProducts = JSON.parse(result.value);
                        if (JSON.stringify(newProducts) !== JSON.stringify(products)) {
                            products = newProducts;
                            renderProducts();
                        }
                    }
                } catch (error) {
                    console.log('Erro ao atualizar produtos');
                }
            }
        }, 5000);

        elements.loginBtn.addEventListener('click', function() {
            elements.loginModal.style.display = 'flex';
            elements.passwordInput.focus();
        });

        elements.closeLoginModal.addEventListener('click', function() {
            elements.loginModal.style.display = 'none';
            elements.passwordInput.value = '';
            elements.loginError.style.display = 'none';
        });

        elements.loginSubmit.addEventListener('click', handleLogin);
        elements.passwordInput.addEventListener('keypress', function(e) {
            if (e.key === 'Enter') handleLogin();
        });

        function handleLogin() {
            if (elements.passwordInput.value === ADMIN_PASSWORD) {
                isAdmin = true;
                elements.loginModal.style.display = 'none';
                elements.loginBtn.style.display = 'none';
                elements.logoutBtn.style.display = 'flex';
                elements.adminControls.style.display = 'flex';
                elements.passwordInput.value = '';
                elements.loginError.style.display = 'none';
                renderProducts();
            } else {
                elements.loginError.style.display = 'block';
                elements.passwordInput.value = '';
            }
        }

        elements.logoutBtn.addEventListener('click', function() {
            isAdmin = false;
            elements.loginBtn.style.display = 'flex';
            elements.logoutBtn.style.display = 'none';
            elements.adminControls.style.display = 'none';
            elements.productForm.style.display = 'none';
            renderProducts();
        });

        elements.addProductBtn.addEventListener('click', function() {
            editingId = null;
            elements.formTitle.textContent = 'Novo Produto';
            elements.saveProduct.textContent = 'Adicionar Produto';
            elements.productName.value = '';
            elements.productImage.value = '';
            elements.productForm.style.display = 'block';
        });

        elements.closeForm.addEventListener('click', function() {
            elements.productForm.style.display = 'none';
            editingId = null;
        });

        elements.saveProduct.addEventListener('click', async function() {
            if (!elements.productName.value || !elements.productImage.value) return;
            
            if (editingId) {
                products = products.map(function(p) {
                    return p.id === editingId ? { id: p.id, name: elements.productName.value, image: elements.productImage.value } : p;
                });
            } else {
                products.push({ 
                    id: Date.now(), 
                    name: elements.productName.value, 
                    image: elements.productImage.value 
                });
            }
            
            await saveProducts();
            renderProducts();
            elements.productForm.style.display = 'none';
            editingId = null;
        });

        window.editProduct = function(id) {
            const product = products.find(function(p) { return p.id === id; });
            if (!product) return;
            
            editingId = id;
            elements.formTitle.textContent = 'Editar Produto';
            elements.saveProduct.textContent = 'Salvar Altera√ß√µes';
            elements.productName.value = product.name;
            elements.productImage.value = product.image;
            elements.productForm.style.display = 'block';
        };

        window.deleteProduct = async function(id) {
            if (!confirm('Deseja realmente excluir este produto?')) return;
            products = products.filter(function(p) { return p.id !== id; });
            await saveProducts();
            renderProducts();
        };

        loadProducts();
    </script>
</body>
</html>
